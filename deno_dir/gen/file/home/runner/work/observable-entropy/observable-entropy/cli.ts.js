import { parse } from "https://deno.land/std@0.98.0/flags/mod.ts";
import { ensureDirSync, existsSync, } from "https://deno.land/std@0.98.0/fs/mod.ts";
import { createHash } from "https://deno.land/std@0.98.0/hash/mod.ts";
import { assertObjectMatch } from "https://deno.land/std@0.98.0/testing/asserts.ts";
import { retryAsync } from "https://deno.land/x/retry@v2.0.0/mod.ts";
import * as ed from "https://deno.land/x/ed25519@1.0.1/mod.ts";
import Client, { HTTP, } from "https://cdn.jsdelivr.net/npm/drand-client@0.2.0/drand.js";
const DENO_LOCK_FILE = "lock.json";
const ENTROPY_FILE = "entropy.json";
const ENTROPY_DIR = "./entropy";
const PREV_ENTROPY_FILE = `${ENTROPY_DIR}/entropy_previous.json`;
const INDEX_DIR = "index/by/entropy_hash";
const HASH_TYPE = "sha256";
const HASH_ITERATIONS = 500000;
const SHA1_REGEX = /^(?:(0x)*([A-Fa-f0-9]{2}){20})$/i;
const SHA256_REGEX = /^(?:(0x)*([A-Fa-f0-9]{2}){32})$/i;
const NOW = new Date();
async function readJSON(path) {
    const text = await Deno.readTextFile(path);
    return JSON.parse(text);
}
async function readJSONFromURL(url) {
    const response = await fetch(url);
    const json = await response.json();
    return json;
}
async function writeJSON(path, data) {
    await Deno.writeTextFile(path, JSON.stringify(data, null, 2));
}
function getPrivateKey() {
    const privKey = Deno.env.get("ED25519_PRIVATE_KEY") || "";
    if (!privKey || privKey === "") {
        throw new Error("missing required environment variable ED25519_PRIVATE_KEY");
    }
    return privKey;
}
async function getPublicKey() {
    const publicKey = await retryAsync(async () => {
        console.log("verify : retrieve public key");
        const publicKeyObj = await readJSONFromURL("https://entropy.truestamp.com/pubkey");
        const publicKey = publicKeyObj?.key;
        if (!publicKey || publicKey === "") {
            throw new Error("failed to retrieve required ed25519 public key from https://entropy.truestamp.com/pubkey");
        }
        return publicKey;
    }, { delay: 1000, maxTry: 5 });
    return publicKey;
}
const getFiles = () => {
    const files = [];
    for (const dirEntry of Deno.readDirSync(ENTROPY_DIR)) {
        if (dirEntry.isFile && dirEntry.name.endsWith(".json")) {
            files.push({ name: dirEntry.name });
        }
    }
    files.map((file) => {
        const data = Deno.readFileSync(`${ENTROPY_DIR}/${file.name}`);
        const hash = createHash(HASH_TYPE);
        hash.update(data);
        file.hash = hash.toString();
        file.hashType = HASH_TYPE;
        return file;
    });
    const sortedFiles = files.sort(function (a, b) {
        var nameA = a.name.toUpperCase();
        var nameB = b.name.toUpperCase();
        if (nameA < nameB) {
            return -1;
        }
        if (nameA > nameB) {
            return 1;
        }
        return 0;
    });
    return sortedFiles;
};
const concatenateFileHashes = (files) => {
    const hashes = [];
    for (const file of files) {
        hashes.push(file.hash);
    }
    return hashes.join("");
};
const genSlowHash = (hash) => {
    let newHash = hash;
    for (let i = 0; i < HASH_ITERATIONS; i++) {
        const hash = createHash(HASH_TYPE);
        hash.update(newHash);
        newHash = hash.toString();
    }
    return newHash;
};
const genEntropy = async () => {
    const files = getFiles();
    const concatenatedFileHashes = concatenateFileHashes(files);
    const slowHash = genSlowHash(concatenatedFileHashes);
    const entropy = {
        files: files,
        hashType: HASH_TYPE,
        hashIterations: HASH_ITERATIONS,
        hash: slowHash,
        createdAt: NOW.toISOString(),
    };
    let hashSig;
    if (parsedArgs["entropy-generate"]) {
        hashSig = await ed.sign(entropy.hash, getPrivateKey());
        entropy.signature = hashSig;
    }
    let prevEntropy;
    if (existsSync(PREV_ENTROPY_FILE)) {
        prevEntropy = await readJSON(PREV_ENTROPY_FILE);
        entropy.prevHash = prevEntropy?.hash;
    }
    console.log(JSON.stringify(entropy, null, 2));
    return entropy;
};
const parsedArgs = parse(Deno.args, {
    boolean: [
        "clean",
        "collect",
        "collect-timestamp",
        "collect-bitcoin",
        "collect-ethereum",
        "collect-stellar",
        "collect-drand",
        "collect-hn",
        "collect-nist",
        "collect-user-entropy",
        "entropy-generate",
        "entropy-verify",
        "entropy-index",
        "entropy-upload-kv"
    ],
});
if (parsedArgs["clean"]) {
    console.log("clean");
    for (const dirEntry of Deno.readDirSync(".")) {
        if (dirEntry.isFile && dirEntry.name.endsWith(".json") &&
            dirEntry.name !== ENTROPY_FILE &&
            dirEntry.name !== DENO_LOCK_FILE) {
            Deno.removeSync(dirEntry.name);
        }
    }
}
if (parsedArgs["collect"] || parsedArgs["collect-timestamp"]) {
    await retryAsync(async () => {
        console.log("collect attempt : timestamp");
        ensureDirSync(ENTROPY_DIR);
        await writeJSON(`${ENTROPY_DIR}/timestamp.json`, {
            timestamp: NOW.toISOString(),
        });
    }, { delay: 1000, maxTry: 5 });
}
if (parsedArgs["collect"] || parsedArgs["collect-bitcoin"]) {
    try {
        await retryAsync(async () => {
            console.log("collect attempt : bitcoin");
            const latestBlock = await readJSONFromURL("https://blockchain.info/latestblock");
            const { height, hash, time, block_index: blockIndex } = latestBlock;
            ensureDirSync(ENTROPY_DIR);
            await writeJSON(`${ENTROPY_DIR}/bitcoin.json`, {
                height,
                hash,
                time,
                blockIndex,
            });
        }, { delay: 1000, maxTry: 5 });
    }
    catch (error) {
        console.error(`collect failed : ${error.message}`);
    }
}
if (parsedArgs["collect"] || parsedArgs["collect-ethereum"]) {
    try {
        await retryAsync(async () => {
            console.log("collect attempt : ethereum");
            const latestBlock = await readJSONFromURL("https://api.blockcypher.com/v1/eth/main");
            ensureDirSync(ENTROPY_DIR);
            await writeJSON(`${ENTROPY_DIR}/ethereum.json`, latestBlock);
        }, { delay: 1000, maxTry: 5 });
    }
    catch (error) {
        console.error(`collect failed : ${error.message}`);
    }
}
if (parsedArgs["collect"] || parsedArgs["collect-nist"]) {
    try {
        await retryAsync(async () => {
            console.log("collect attempt : nist-beacon");
            const latestPulse = await readJSONFromURL("https://beacon.nist.gov/beacon/2.0/pulse/last");
            ensureDirSync(ENTROPY_DIR);
            await writeJSON(`${ENTROPY_DIR}/nist-beacon.json`, latestPulse);
        }, { delay: 1000, maxTry: 5 });
    }
    catch (error) {
        console.error(`collect failed : ${error.message}`);
    }
}
if (parsedArgs["collect"] || parsedArgs["collect-user-entropy"]) {
    try {
        await retryAsync(async () => {
            console.log("collect attempt : user-entropy");
            const entries = await readJSONFromURL("https://entropy.truestamp.com/entries");
            if (!Array.isArray(entries)) {
                throw new Error(`collect attempt : user-entropy : expected Array, got ${entries}`);
            }
            ensureDirSync(ENTROPY_DIR);
            await writeJSON(`${ENTROPY_DIR}/user-entropy.json`, { entries });
        }, { delay: 1000, maxTry: 5 });
    }
    catch (error) {
        console.error(`collect failed : ${error.message}`);
    }
}
if (parsedArgs["collect"] || parsedArgs["collect-stellar"]) {
    try {
        await retryAsync(async () => {
            console.log("collect attempt : stellar");
            const feeStats = await readJSONFromURL("https://horizon.stellar.org/fee_stats");
            const latestLedger = await readJSONFromURL(`https://horizon.stellar.org/ledgers/${feeStats.last_ledger}`);
            ensureDirSync(ENTROPY_DIR);
            await writeJSON(`${ENTROPY_DIR}/stellar.json`, latestLedger);
        }, { delay: 1000, maxTry: 5 });
    }
    catch (error) {
        console.error(`collect failed : ${error.message}`);
    }
}
if (parsedArgs["collect"] || parsedArgs["collect-drand"]) {
    try {
        await retryAsync(async () => {
            console.log("collect attempt : drand-beacon");
            const urls = [
                "https://drand.cloudflare.com",
            ];
            const chainInfo = await readJSONFromURL("https://drand.cloudflare.com/info");
            const options = { chainInfo };
            const client = await Client.wrap(HTTP.forURLs(urls, chainInfo.hash), options);
            const randomness = await client.get();
            await client.close();
            ensureDirSync(ENTROPY_DIR);
            await writeJSON(`${ENTROPY_DIR}/drand-beacon.json`, {
                chainInfo,
                randomness,
            });
        }, { delay: 1000, maxTry: 5 });
    }
    catch (error) {
        console.error(`collect failed : ${error.message}`);
    }
}
if (parsedArgs["collect"] || parsedArgs["collect-hn"]) {
    try {
        await retryAsync(async () => {
            console.log("collect attempt : hacker-news");
            const newsStories = await readJSONFromURL("https://hacker-news.firebaseio.com/v0/newstories.json");
            const stories = [];
            for (let i = 0; i < 10; i++) {
                const story = await readJSONFromURL(`https://hacker-news.firebaseio.com/v0/item/${newsStories[i]}.json`);
                stories.push(story);
            }
            ensureDirSync(ENTROPY_DIR);
            await writeJSON(`${ENTROPY_DIR}/hacker-news.json`, { stories });
        }, { delay: 1000, maxTry: 5 });
    }
    catch (error) {
        console.error(`collect failed : ${error.message}`);
    }
}
if (parsedArgs["entropy-generate"]) {
    if (existsSync(ENTROPY_FILE)) {
        Deno.copyFileSync(ENTROPY_FILE, PREV_ENTROPY_FILE);
        console.log(`entropy : copied to '${PREV_ENTROPY_FILE}'`);
    }
    const entropy = await genEntropy();
    await writeJSON(ENTROPY_FILE, entropy);
    console.log("entropy : generated");
}
if (parsedArgs["entropy-verify"]) {
    if (!existsSync(ENTROPY_FILE)) {
        throw new Error(`required file '${ENTROPY_FILE}' not found`);
    }
    const currentEntropy = await readJSON(ENTROPY_FILE);
    const publicKey = await getPublicKey();
    if (!publicKey) {
        throw new Error("unable to retrieve public key for verification");
    }
    if (!await ed.verify(currentEntropy.signature, currentEntropy.hash, publicKey)) {
        throw new Error("invalid hash signature");
    }
    const entropy = await genEntropy();
    delete currentEntropy.createdAt;
    delete entropy.createdAt;
    assertObjectMatch(currentEntropy, entropy);
    console.log("entropy : verified");
}
if (parsedArgs["entropy-index"]) {
    const parentCommitId = Deno.env.get("PARENT_COMMIT_ID") || "";
    if (!SHA1_REGEX.test(parentCommitId)) {
        throw new Error("invalid PARENT_COMMIT_ID environment variable, must be SHA1 commit ID");
    }
    if (existsSync(PREV_ENTROPY_FILE)) {
        const prevEntropy = await readJSON(PREV_ENTROPY_FILE);
        const prevEntropyHash = prevEntropy?.hash;
        if (!prevEntropyHash || !SHA256_REGEX.test(prevEntropyHash)) {
            throw new Error("missing or invalid entropy hash in file");
        }
        Deno.mkdirSync(INDEX_DIR, { recursive: true });
        await writeJSON(`${INDEX_DIR}/${prevEntropyHash}.json`, {
            id: parentCommitId,
        });
        console.log(`entropy-index : index file written : '${INDEX_DIR}/${prevEntropyHash}.json' : ${parentCommitId}`);
    }
}
if (parsedArgs["entropy-upload-kv"]) {
    const accountIdentifier = Deno.env.get('CF_ACCOUNT_ID');
    const namespaceIdentifier = Deno.env.get('CF_NAMESPACE_ID');
    const keyName = "latest";
    const expirationTtl = 60 * 6;
    const authEmail = Deno.env.get('CF_AUTH_EMAIL') || '';
    const authKey = Deno.env.get('CF_AUTH_KEY') || '';
    const url = `https://api.cloudflare.com/client/v4/accounts/${accountIdentifier}/storage/kv/namespaces/${namespaceIdentifier}/values/${keyName}?expiration_ttl=${expirationTtl}`;
    const entropyFile = await readJSON(ENTROPY_FILE);
    let json;
    try {
        const response = await fetch(url, {
            method: "PUT",
            headers: {
                "X-Auth-Email": authEmail,
                "X-Auth-Key": authKey,
                "Content-Type": "application/json",
            },
            body: JSON.stringify(entropyFile),
        });
        json = await response.json();
    }
    catch (error) {
        console.error(`entropy-upload-kv : ${error.message}`);
    }
    if (json.success) {
        console.log(`entropy-upload-kv : success : latest entropy.json file written to Cloudflare KV : ${JSON.stringify(json)}`);
    }
    else {
        console.log(`entropy-upload-kv : failed : latest entropy.json file was NOT written to Cloudflare KV : ${JSON.stringify(json)}`);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2xpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSwyQ0FBMkMsQ0FBQztBQUNsRSxPQUFPLEVBQ0wsYUFBYSxFQUNiLFVBQVUsR0FDWCxNQUFNLHdDQUF3QyxDQUFDO0FBQ2hELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUN0RSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxpREFBaUQsQ0FBQztBQUVwRixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFFckUsT0FBTyxLQUFLLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUUvRCxPQUFPLE1BQU0sRUFBRSxFQUNiLElBQUksR0FDTCxNQUFNLDBEQUEwRCxDQUFDO0FBRWxFLE1BQU0sY0FBYyxHQUFHLFdBQVcsQ0FBQztBQUNuQyxNQUFNLFlBQVksR0FBRyxjQUFjLENBQUM7QUFDcEMsTUFBTSxXQUFXLEdBQUcsV0FBVyxDQUFDO0FBQ2hDLE1BQU0saUJBQWlCLEdBQUcsR0FBRyxXQUFXLHdCQUF3QixDQUFDO0FBQ2pFLE1BQU0sU0FBUyxHQUFHLHVCQUF1QixDQUFDO0FBQzFDLE1BQU0sU0FBUyxHQUFHLFFBQVEsQ0FBQztBQUMzQixNQUFNLGVBQWUsR0FBRyxNQUFNLENBQUM7QUFDL0IsTUFBTSxVQUFVLEdBQUcsa0NBQWtDLENBQUM7QUFDdEQsTUFBTSxZQUFZLEdBQUcsa0NBQWtDLENBQUM7QUFDeEQsTUFBTSxHQUFHLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztBQW9CdkIsS0FBSyxVQUFVLFFBQVEsQ0FBQyxJQUFZO0lBQ2xDLE1BQU0sSUFBSSxHQUFHLE1BQU0sSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMzQyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDMUIsQ0FBQztBQUVE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T0FBTyxLQUFLLEVBQUU7UUFDZCxPQUFPLENBQUMsS0FBSyxDQUFDLHVCQUF1QixLQUFLLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztLQUN2RDtJQUVELElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtRQUNoQixPQUFPLENBQUMsR0FBRyxDQUNULHFGQUFxRixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQzVHLENBQUM7S0FDSDtTQUFNO1FBQ0wsT0FBTyxDQUFDLEdBQUcsQ0FDVCw0RkFBNEYsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUNuSCxDQUFDO0tBQ0g7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhcnNlIH0gZnJvbSBcImh0dHBzOi8vZGVuby5sYW5kL3N0ZEAwLjk4LjAvZmxhZ3MvbW9kLnRzXCI7XG5pbXBvcnQge1xuICBlbnN1cmVEaXJTeW5jLFxuICBleGlzdHNTeW5jLFxufSBmcm9tIFwiaHR0cHM6Ly9kZW5vLmxhbmQvc3RkQDAuOTguMC9mcy9tb2QudHNcIjtcbmltcG9ydCB7IGNyZWF0ZUhhc2ggfSBmcm9tIFwiaHR0cHM6Ly9kZW5vLmxhbmQvc3RkQDAuOTguMC9oYXNoL21vZC50c1wiO1xuaW1wb3J0IHsgYXNzZXJ0T2JqZWN0TWF0Y2ggfSBmcm9tIFwiaHR0cHM6Ly9kZW5vLmxhbmQvc3RkQDAuOTguMC90ZXN0aW5nL2Fzc2VydHMudHNcIjtcblxuaW1wb3J0IHsgcmV0cnlBc3luYyB9IGZyb20gXCJodHRwczovL2Rlbm8ubGFuZC94L3JldHJ5QHYyLjAuMC9tb2QudHNcIjtcblxuaW1wb3J0ICogYXMgZWQgZnJvbSBcImh0dHBzOi8vZGVuby5sYW5kL3gvZWQyNTUxOUAxLjAuMS9tb2QudHNcIjtcblxuaW1wb3J0IENsaWVudCwge1xuICBIVFRQLFxufSBmcm9tIFwiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9kcmFuZC1jbGllbnRAMC4yLjAvZHJhbmQuanNcIjtcblxuY29uc3QgREVOT19MT0NLX0ZJTEUgPSBcImxvY2suanNvblwiO1xuY29uc3QgRU5UUk9QWV9GSUxFID0gXCJlbnRyb3B5Lmpzb25cIjtcbmNvbnN0IEVOVFJPUFlfRElSID0gXCIuL2VudHJvcHlcIjtcbmNvbnN0IFBSRVZfRU5UUk9QWV9GSUxFID0gYCR7RU5UUk9QWV9ESVJ9L2VudHJvcHlfcHJldmlvdXMuanNvbmA7XG5jb25zdCBJTkRFWF9ESVIgPSBcImluZGV4L2J5L2VudHJvcHlfaGFzaFwiO1xuY29uc3QgSEFTSF9UWVBFID0gXCJzaGEyNTZcIjtcbmNvbnN0IEhBU0hfSVRFUkFUSU9OUyA9IDUwMDAwMDtcbmNvbnN0IFNIQTFfUkVHRVggPSAvXig/OigweCkqKFtBLUZhLWYwLTldezJ9KXsyMH0pJC9pO1xuY29uc3QgU0hBMjU2X1JFR0VYID0gL14oPzooMHgpKihbQS1GYS1mMC05XXsyfSl7MzJ9KSQvaTtcbmNvbnN0IE5PVyA9IG5ldyBEYXRlKCk7XG5cbmludGVyZmFjZSBKU09ORmlsZSB7XG4gIG5hbWU6IHN0cmluZztcbiAgaGFzaD86IHN0cmluZztcbiAgaGFzaFR5cGU/OiBzdHJpbmc7XG59XG5cbnR5cGUgSlNPTkZpbGVzID0gSlNPTkZpbGVbXTtcblxudHlwZSBFbnRyb3B5ID0ge1xuICBmaWxlczogSlNPTkZpbGVzO1xuICBoYXNoVHlwZTogc3RyaW5nO1xuICBoYXNoSXRlcmF0aW9uczogbnVtYmVyO1xuICBoYXNoOiBzdHJpbmc7XG4gIHByZXZIYXNoPzogc3RyaW5nO1xuICBzaWduYXR1cmU/OiBzdHJpbmc7XG4gIGNyZWF0ZWRBdD86IHN0cmluZztcbn07XG5cbmFzeW5jIGZ1bmN0aW9uIHJlYWRKU09OKHBhdGg6IHN0cmluZykge1xuICBjb25zdCB0ZXh0ID0gYXdhaXQgRGVuby5yZWFkVGV4dEZpbGUocGF0aCk7XG4gIHJldHVybiBKU09OLnBhcnNlKHRleHQpO1xufVxuXG5hc3luYyBmdW5jdGlvbiByZWFkSlNPTkZyb21VUkwodXJsOiBzdHJpbmcpIHtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICBjb25zdCBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICByZXR1cm4ganNvbjtcbn1cblxuYXN5bmMgZnVuY3Rpb24gd3JpdGVKU09OKHBhdGg6IHN0cmluZywgZGF0YTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pIHtcbiAgYXdhaXQgRGVuby53cml0ZVRleHRGaWxlKHBhdGgsIEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpKTtcbn1cblxuZnVuY3Rpb24gZ2V0UHJpdmF0ZUtleSgpOiBzdHJpbmcge1xuICBjb25zdCBwcml2S2V5ID0gRGVuby5lbnYuZ2V0KFwiRUQyNTUxOV9QUklWQVRFX0tFWVwiKSB8fCBcIlwiO1xuICBpZiAoIXByaXZLZXkgfHwgcHJpdktleSA9PT0gXCJcIikge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIFwibWlzc2luZyByZXF1aXJlZCBlbnZpcm9ubWVudCB2YXJpYWJsZSBFRDI1NTE5X1BSSVZBVEVfS0VZXCIsXG4gICAgKTtcbiAgfVxuICByZXR1cm4gcHJpdktleTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0UHVibGljS2V5KCk6IFByb21pc2U8c3RyaW5nIHwgdW5kZWZpbmVkPiB7XG4gIGNvbnN0IHB1YmxpY0tleSA9IGF3YWl0IHJldHJ5QXN5bmMoXG4gICAgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJ2ZXJpZnkgOiByZXRyaWV2ZSBwdWJsaWMga2V5XCIpO1xuICAgICAgY29uc3QgcHVibGljS2V5T2JqID0gYXdhaXQgcmVhZEpTT05Gcm9tVVJMKFxuICAgICAgICBcImh0dHBzOi8vZW50cm9weS50cnVlc3RhbXAuY29tL3B1YmtleVwiLFxuICAgICAgKTtcbiAgICAgIGNvbnN0IHB1YmxpY0tleSA9IHB1YmxpY0tleU9iaj8ua2V5O1xuICAgICAgaWYgKCFwdWJsaWNLZXkgfHwgcHVibGljS2V5ID09PSBcIlwiKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICBcImZhaWxlZCB0byByZXRyaWV2ZSByZXF1aXJlZCBlZDI1NTE5IHB1YmxpYyBrZXkgZnJvbSBodHRwczovL2VudHJvcHkudHJ1ZXN0YW1wLmNvbS9wdWJrZXlcIixcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwdWJsaWNLZXk7XG4gICAgfSxcbiAgICB7IGRlbGF5OiAxMDAwLCBtYXhUcnk6IDUgfSxcbiAgKTtcblxuICByZXR1cm4gcHVibGljS2V5O1xufVxuXG4vLyBGaW5kIGFsbCAqLmpzb24gZmlsZXMgaW4gdGhpcyBkaXIgZm9yIGhhc2hpbmcuXG4vLyBJbmNsdWRlcyB0aGUgcHJldmlvdXMgZW50cm9weSBmaWxlIGJ1dCBub3QgdGhlIGN1cnJlbnQgb25lLlxuY29uc3QgZ2V0RmlsZXMgPSAoKTogSlNPTkZpbGVzID0+IHtcbiAgY29uc3QgZmlsZXM6IEpTT05GaWxlcyA9IFtdO1xuXG4gIC8vIGNvbGxlY3QgdGhlICcuanNvbicgZmlsZXMgZnJvbSBkaXJcbiAgZm9yIChjb25zdCBkaXJFbnRyeSBvZiBEZW5vLnJlYWREaXJTeW5jKEVOVFJPUFlfRElSKSkge1xuICAgIGlmIChcbiAgICAgIGRpckVudHJ5LmlzRmlsZSAmJiBkaXJFbnRyeS5uYW1lLmVuZHNXaXRoKFwiLmpzb25cIilcbiAgICApIHtcbiAgICAgIGZpbGVzLnB1c2goeyBuYW1lOiBkaXJFbnRyeS5uYW1lIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIGNhbGN1bGF0ZSB0aGUgaGFzaCBvZiBlYWNoIGZpbGVcbiAgZmlsZXMubWFwKChmaWxlKSA9PiB7XG4gICAgY29uc3QgZGF0YSA9IERlbm8ucmVhZEZpbGVTeW5jKGAke0VOVFJPUFlfRElSfS8ke2ZpbGUubmFtZX1gKTtcbiAgICBjb25zdCBoYXNoID0gY3JlYXRlSGFzaChIQVNIX1RZUEUpO1xuICAgIGhhc2gudXBkYXRlKGRhdGEpO1xuICAgIGZpbGUuaGFzaCA9IGhhc2gudG9TdHJpbmcoKTtcbiAgICBmaWxlLmhhc2hUeXBlID0gSEFTSF9UWVBFO1xuICAgIHJldHVybiBmaWxlO1xuICB9KTtcblxuICAvLyBzb3J0IEFycmF5IG9mIE9iamVjdHMgYnkgZmlsZSBuYW1lIHNvIHRoZSBzb3J0IG9yZGVyIGFuZCByZXN1bHRhbnQgaGFzaCBpcyBkZXRlcm1pbmlzdGljXG4gIGNvbnN0IHNvcnRlZEZpbGVzID0gZmlsZXMuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgIHZhciBuYW1lQSA9IGEubmFtZS50b1VwcGVyQ2FzZSgpOyAvLyBpZ25vcmUgdXBwZXIgYW5kIGxvd2VyY2FzZVxuICAgIHZhciBuYW1lQiA9IGIubmFtZS50b1VwcGVyQ2FzZSgpOyAvLyBpZ25vcmUgdXBwZXIgYW5kIGxvd2VyY2FzZVxuICAgIGlmIChuYW1lQSA8IG5hbWVCKSB7XG4gICAgICByZXR1cm4gLTE7IC8vbmFtZUEgY29tZXMgZmlyc3RcbiAgICB9XG4gICAgaWYgKG5hbWVBID4gbmFtZUIpIHtcbiAgICAgIHJldHVybiAxOyAvLyBuYW1lQiBjb21lcyBmaXJzdFxuICAgIH1cbiAgICByZXR1cm4gMDsgLy8gbmFtZXMgbXVzdCBiZSBlcXVhbFxuICB9KTtcblxuICByZXR1cm4gc29ydGVkRmlsZXM7XG59O1xuXG4vLyBjb25jYXRlbmF0ZSBhbGwgb2YgdGhlIGluZGl2aWR1YWwgZmlsZXMgaGFzaGVzIGludG8gb25lIGxvbmcgaGFzaCBzdHJpbmdcbmNvbnN0IGNvbmNhdGVuYXRlRmlsZUhhc2hlcyA9IChmaWxlczogSlNPTkZpbGVzKTogc3RyaW5nID0+IHtcbiAgY29uc3QgaGFzaGVzID0gW107XG4gIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgIGhhc2hlcy5wdXNoKGZpbGUuaGFzaCk7XG4gIH1cbiAgcmV0dXJuIGhhc2hlcy5qb2luKFwiXCIpO1xufTtcblxuLy8gZ2VuZXJhdGUgYSBuZXcgaGFzaCBzbG93bHkgKG5hw692ZSB1bmljb3JuIHN0eWxlICdzbG90aCcgZnVuY3Rpb24pXG5jb25zdCBnZW5TbG93SGFzaCA9IChoYXNoOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICBsZXQgbmV3SGFzaCA9IGhhc2g7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBIQVNIX0lURVJBVElPTlM7IGkrKykge1xuICAgIGNvbnN0IGhhc2ggPSBjcmVhdGVIYXNoKEhBU0hfVFlQRSk7XG4gICAgaGFzaC51cGRhdGUobmV3SGFzaCk7XG4gICAgbmV3SGFzaCA9IGhhc2gudG9TdHJpbmcoKTtcbiAgfVxuXG4gIHJldHVybiBuZXdIYXNoO1xufTtcblxuY29uc3QgZ2VuRW50cm9weSA9IGFzeW5jICgpOiBQcm9taXNlPEVudHJvcHk+ID0+IHtcbiAgY29uc3QgZmlsZXMgPSBnZXRGaWxlcygpO1xuICBjb25zdCBjb25jYXRlbmF0ZWRGaWxlSGFzaGVzID0gY29uY2F0ZW5hdGVGaWxlSGFzaGVzKGZpbGVzKTtcbiAgY29uc3Qgc2xvd0hhc2ggPSBnZW5TbG93SGFzaChjb25jYXRlbmF0ZWRGaWxlSGFzaGVzKTtcblxuICBjb25zdCBlbnRyb3B5OiBFbnRyb3B5ID0ge1xuICAgIGZpbGVzOiBmaWxlcyxcbiAgICBoYXNoVHlwZTogSEFTSF9UWVBFLFxuICAgIGhhc2hJdGVyYXRpb25zOiBIQVNIX0lURVJBVElPTlMsXG4gICAgaGFzaDogc2xvd0hhc2gsXG4gICAgY3JlYXRlZEF0OiBOT1cudG9JU09TdHJpbmcoKSxcbiAgfTtcblxuICBsZXQgaGFzaFNpZztcbiAgaWYgKHBhcnNlZEFyZ3NbXCJlbnRyb3B5LWdlbmVyYXRlXCJdKSB7XG4gICAgaGFzaFNpZyA9IGF3YWl0IGVkLnNpZ24oZW50cm9weS5oYXNoLCBnZXRQcml2YXRlS2V5KCkpO1xuICAgIGVudHJvcHkuc2lnbmF0dXJlID0gaGFzaFNpZztcbiAgfVxuXG4gIGxldCBwcmV2RW50cm9weTtcbiAgaWYgKGV4aXN0c1N5bmMoUFJFVl9FTlRST1BZX0ZJTEUpKSB7XG4gICAgcHJldkVudHJvcHkgPSBhd2FpdCByZWFkSlNPTihQUkVWX0VOVFJPUFlfRklMRSk7XG4gICAgZW50cm9weS5wcmV2SGFzaCA9IHByZXZFbnRyb3B5Py5oYXNoO1xuICB9XG5cbiAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZW50cm9weSwgbnVsbCwgMikpO1xuICByZXR1cm4gZW50cm9weTtcbn07XG5cbi8vIENMSSBBcmd1bWVudCBIYW5kbGVyXG5jb25zdCBwYXJzZWRBcmdzID0gcGFyc2UoRGVuby5hcmdzLCB7XG4gIGJvb2xlYW46IFtcbiAgICBcImNsZWFuXCIsXG4gICAgXCJjb2xsZWN0XCIsXG4gICAgXCJjb2xsZWN0LXRpbWVzdGFtcFwiLFxuICAgIFwiY29sbGVjdC1iaXRjb2luXCIsXG4gICAgXCJjb2xsZWN0LWV0aGVyZXVtXCIsXG4gICAgXCJjb2xsZWN0LXN0ZWxsYXJcIixcbiAgICBcImNvbGxlY3QtZHJhbmRcIixcbiAgICBcImNvbGxlY3QtaG5cIixcbiAgICBcImNvbGxlY3QtbmlzdFwiLFxuICAgIFwiY29sbGVjdC11c2VyLWVudHJvcHlcIixcbiAgICBcImVudHJvcHktZ2VuZXJhdGVcIixcbiAgICBcImVudHJvcHktdmVyaWZ5XCIsXG4gICAgXCJlbnRyb3B5LWluZGV4XCIsXG4gICAgXCJlbnRyb3B5LXVwbG9hZC1rdlwiXG4gIF0sXG59KTtcblxuLy8gQ0xFQU5VUFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8vIC0tY2xlYW5cbmlmIChwYXJzZWRBcmdzW1wiY2xlYW5cIl0pIHtcbiAgY29uc29sZS5sb2coXCJjbGVhblwiKTtcbiAgLy8gQ2xlYW51cCBhbnkgY29sbGVjdGVkICouanNvbiBmaWxlcyAoZm9yIGRldmVsb3BtZW50KVxuICBmb3IgKGNvbnN0IGRpckVudHJ5IG9mIERlbm8ucmVhZERpclN5bmMoXCIuXCIpKSB7XG4gICAgaWYgKFxuICAgICAgZGlyRW50cnkuaXNGaWxlICYmIGRpckVudHJ5Lm5hbWUuZW5kc1dpdGgoXCIuanNvblwiKSAmJlxuICAgICAgZGlyRW50cnkubmFtZSAhPT0gRU5UUk9QWV9GSUxFICYmXG4gICAgICBkaXJFbnRyeS5uYW1lICE9PSBERU5PX0xPQ0tfRklMRVxuICAgICkge1xuICAgICAgRGVuby5yZW1vdmVTeW5jKGRpckVudHJ5Lm5hbWUpO1xuICAgIH1cbiAgfVxufVxuXG4vLyBFTlRST1BZIENPTExFQ1RJT05cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vLyBFYWNoIGNvbGxlY3Rpb24gc291cmNlIHdpbGwgYmUgcmV0cmllZCBvbiBmYWlsdXJlLCBidXQgaWYgaXRcbi8vIGZpbmFsbHkgc3RpbGwgcmFpc2VzIGFuIGVycm9yIGl0IHdpbGwganVzdCBiZSBsb2dnZWQgYW5kIHRoaXNcbi8vIHNvdXJjZSB3aWxsIGJlIHNraXBwZWQuXG5cbi8vIFRJTUVTVEFNUFxuaWYgKHBhcnNlZEFyZ3NbXCJjb2xsZWN0XCJdIHx8IHBhcnNlZEFyZ3NbXCJjb2xsZWN0LXRpbWVzdGFtcFwiXSkge1xuICBhd2FpdCByZXRyeUFzeW5jKFxuICAgIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiY29sbGVjdCBhdHRlbXB0IDogdGltZXN0YW1wXCIpO1xuICAgICAgZW5zdXJlRGlyU3luYyhFTlRST1BZX0RJUik7XG4gICAgICBhd2FpdCB3cml0ZUpTT04oYCR7RU5UUk9QWV9ESVJ9L3RpbWVzdGFtcC5qc29uYCwge1xuICAgICAgICB0aW1lc3RhbXA6IE5PVy50b0lTT1N0cmluZygpLFxuICAgICAgfSk7XG4gICAgfSxcbiAgICB7IGRlbGF5OiAxMDAwLCBtYXhUcnk6IDUgfSxcbiAgKTtcbn1cblxuLy8gQklUQ09JTlxuaWYgKHBhcnNlZEFyZ3NbXCJjb2xsZWN0XCJdIHx8IHBhcnNlZEFyZ3NbXCJjb2xsZWN0LWJpdGNvaW5cIl0pIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCByZXRyeUFzeW5jKFxuICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhcImNvbGxlY3QgYXR0ZW1wdCA6IGJpdGNvaW5cIik7XG4gICAgICAgIGNvbnN0IGxhdGVzdEJsb2NrID0gYXdhaXQgcmVhZEpTT05Gcm9tVVJMKFxuICAgICAgICAgIFwiaHR0cHM6Ly9ibG9ja2NoYWluLmluZm8vbGF0ZXN0YmxvY2tcIixcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBleHRyYWN0IGp1c3QgdGhlIGRhdGEgd2Ugd2FudFxuICAgICAgICBjb25zdCB7IGhlaWdodCwgaGFzaCwgdGltZSwgYmxvY2tfaW5kZXg6IGJsb2NrSW5kZXggfSA9IGxhdGVzdEJsb2NrO1xuICAgICAgICBlbnN1cmVEaXJTeW5jKEVOVFJPUFlfRElSKTtcbiAgICAgICAgYXdhaXQgd3JpdGVKU09OKGAke0VOVFJPUFlfRElSfS9iaXRjb2luLmpzb25gLCB7XG4gICAgICAgICAgaGVpZ2h0LFxuICAgICAgICAgIGhhc2gsXG4gICAgICAgICAgdGltZSxcbiAgICAgICAgICBibG9ja0luZGV4LFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICB7IGRlbGF5OiAxMDAwLCBtYXhUcnk6IDUgfSxcbiAgICApO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoYGNvbGxlY3QgZmFpbGVkIDogJHtlcnJvci5tZXNzYWdlfWApO1xuICB9XG59XG5cbi8vIEVUSEVSRVVNXG5pZiAocGFyc2VkQXJnc1tcImNvbGxlY3RcIl0gfHwgcGFyc2VkQXJnc1tcImNvbGxlY3QtZXRoZXJldW1cIl0pIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCByZXRyeUFzeW5jKFxuICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhcImNvbGxlY3QgYXR0ZW1wdCA6IGV0aGVyZXVtXCIpO1xuICAgICAgICBjb25zdCBsYXRlc3RCbG9jayA9IGF3YWl0IHJlYWRKU09ORnJvbVVSTChcbiAgICAgICAgICBcImh0dHBzOi8vYXBpLmJsb2NrY3lwaGVyLmNvbS92MS9ldGgvbWFpblwiLFxuICAgICAgICApO1xuXG4gICAgICAgIGVuc3VyZURpclN5bmMoRU5UUk9QWV9ESVIpO1xuICAgICAgICBhd2FpdCB3cml0ZUpTT04oYCR7RU5UUk9QWV9ESVJ9L2V0aGVyZXVtLmpzb25gLCBsYXRlc3RCbG9jayk7XG4gICAgICB9LFxuICAgICAgeyBkZWxheTogMTAwMCwgbWF4VHJ5OiA1IH0sXG4gICAgKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGBjb2xsZWN0IGZhaWxlZCA6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgfVxufVxuXG4vLyBOSVNUIEJFQUNPTlxuaWYgKHBhcnNlZEFyZ3NbXCJjb2xsZWN0XCJdIHx8IHBhcnNlZEFyZ3NbXCJjb2xsZWN0LW5pc3RcIl0pIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCByZXRyeUFzeW5jKFxuICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhcImNvbGxlY3QgYXR0ZW1wdCA6IG5pc3QtYmVhY29uXCIpO1xuICAgICAgICBjb25zdCBsYXRlc3RQdWxzZSA9IGF3YWl0IHJlYWRKU09ORnJvbVVSTChcbiAgICAgICAgICBcImh0dHBzOi8vYmVhY29uLm5pc3QuZ292L2JlYWNvbi8yLjAvcHVsc2UvbGFzdFwiLFxuICAgICAgICApO1xuXG4gICAgICAgIGVuc3VyZURpclN5bmMoRU5UUk9QWV9ESVIpO1xuICAgICAgICBhd2FpdCB3cml0ZUpTT04oYCR7RU5UUk9QWV9ESVJ9L25pc3QtYmVhY29uLmpzb25gLCBsYXRlc3RQdWxzZSk7XG4gICAgICB9LFxuICAgICAgeyBkZWxheTogMTAwMCwgbWF4VHJ5OiA1IH0sXG4gICAgKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGBjb2xsZWN0IGZhaWxlZCA6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgfVxufVxuXG4vLyBVU0VSIEVOVFJPUFlcbmlmIChwYXJzZWRBcmdzW1wiY29sbGVjdFwiXSB8fCBwYXJzZWRBcmdzW1wiY29sbGVjdC11c2VyLWVudHJvcHlcIl0pIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCByZXRyeUFzeW5jKFxuICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhcImNvbGxlY3QgYXR0ZW1wdCA6IHVzZXItZW50cm9weVwiKTtcbiAgICAgICAgY29uc3QgZW50cmllcyA9IGF3YWl0IHJlYWRKU09ORnJvbVVSTChcbiAgICAgICAgICBcImh0dHBzOi8vZW50cm9weS50cnVlc3RhbXAuY29tL2VudHJpZXNcIixcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZW50cmllcykpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICBgY29sbGVjdCBhdHRlbXB0IDogdXNlci1lbnRyb3B5IDogZXhwZWN0ZWQgQXJyYXksIGdvdCAke2VudHJpZXN9YCxcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgZW5zdXJlRGlyU3luYyhFTlRST1BZX0RJUik7XG4gICAgICAgIGF3YWl0IHdyaXRlSlNPTihgJHtFTlRST1BZX0RJUn0vdXNlci1lbnRyb3B5Lmpzb25gLCB7IGVudHJpZXMgfSk7XG4gICAgICB9LFxuICAgICAgeyBkZWxheTogMTAwMCwgbWF4VHJ5OiA1IH0sXG4gICAgKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGBjb2xsZWN0IGZhaWxlZCA6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgfVxufVxuXG4vLyBTVEVMTEFSXG5pZiAocGFyc2VkQXJnc1tcImNvbGxlY3RcIl0gfHwgcGFyc2VkQXJnc1tcImNvbGxlY3Qtc3RlbGxhclwiXSkge1xuICB0cnkge1xuICAgIGF3YWl0IHJldHJ5QXN5bmMoXG4gICAgICBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiY29sbGVjdCBhdHRlbXB0IDogc3RlbGxhclwiKTtcbiAgICAgICAgLy8gUmV0cmlldmUgdGhlIGxhc3QgbGVkZ2VyIElELlxuICAgICAgICAvLyBjdXJsIC1YIEdFVCBcImh0dHBzOi8vaG9yaXpvbi5zdGVsbGFyLm9yZy9mZWVfc3RhdHNcIiA+IHN0ZWxsYXItZmVlLXN0YXRzLmpzb25cbiAgICAgICAgY29uc3QgZmVlU3RhdHMgPSBhd2FpdCByZWFkSlNPTkZyb21VUkwoXG4gICAgICAgICAgXCJodHRwczovL2hvcml6b24uc3RlbGxhci5vcmcvZmVlX3N0YXRzXCIsXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gUmVhZCB0aGUgbGVkZ2VyIGZvciBsYXN0IGxlZGdlciBJRFxuICAgICAgICBjb25zdCBsYXRlc3RMZWRnZXIgPSBhd2FpdCByZWFkSlNPTkZyb21VUkwoXG4gICAgICAgICAgYGh0dHBzOi8vaG9yaXpvbi5zdGVsbGFyLm9yZy9sZWRnZXJzLyR7ZmVlU3RhdHMubGFzdF9sZWRnZXJ9YCxcbiAgICAgICAgKTtcblxuICAgICAgICBlbnN1cmVEaXJTeW5jKEVOVFJPUFlfRElSKTtcbiAgICAgICAgYXdhaXQgd3JpdGVKU09OKGAke0VOVFJPUFlfRElSfS9zdGVsbGFyLmpzb25gLCBsYXRlc3RMZWRnZXIpO1xuICAgICAgfSxcbiAgICAgIHsgZGVsYXk6IDEwMDAsIG1heFRyeTogNSB9LFxuICAgICk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihgY29sbGVjdCBmYWlsZWQgOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gIH1cbn1cblxuLy8gRFJBTkQgQkVBQ09OXG5pZiAocGFyc2VkQXJnc1tcImNvbGxlY3RcIl0gfHwgcGFyc2VkQXJnc1tcImNvbGxlY3QtZHJhbmRcIl0pIHtcbiAgLy8gRHJhbmQgQmVhY29uXG4gIC8vIGh0dHBzOi8vZHJhbmQubG92ZS9kZXZlbG9wZXIvaHR0cC1hcGkvI3B1YmxpYy1lbmRwb2ludHNcbiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2RyYW5kL2RyYW5kLWNsaWVudFxuXG4gIHRyeSB7XG4gICAgYXdhaXQgcmV0cnlBc3luYyhcbiAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJjb2xsZWN0IGF0dGVtcHQgOiBkcmFuZC1iZWFjb25cIik7XG4gICAgICAgIGNvbnN0IHVybHMgPSBbXG4gICAgICAgICAgXCJodHRwczovL2RyYW5kLmNsb3VkZmxhcmUuY29tXCIsXG4gICAgICAgIF07XG5cbiAgICAgICAgY29uc3QgY2hhaW5JbmZvID0gYXdhaXQgcmVhZEpTT05Gcm9tVVJMKFxuICAgICAgICAgIFwiaHR0cHM6Ly9kcmFuZC5jbG91ZGZsYXJlLmNvbS9pbmZvXCIsXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHsgY2hhaW5JbmZvIH07XG5cbiAgICAgICAgY29uc3QgY2xpZW50ID0gYXdhaXQgQ2xpZW50LndyYXAoXG4gICAgICAgICAgSFRUUC5mb3JVUkxzKHVybHMsIGNoYWluSW5mby5oYXNoKSxcbiAgICAgICAgICBvcHRpb25zLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHJhbmRvbW5lc3MgPSBhd2FpdCBjbGllbnQuZ2V0KCk7XG5cbiAgICAgICAgYXdhaXQgY2xpZW50LmNsb3NlKCk7XG5cbiAgICAgICAgZW5zdXJlRGlyU3luYyhFTlRST1BZX0RJUik7XG4gICAgICAgIGF3YWl0IHdyaXRlSlNPTihgJHtFTlRST1BZX0RJUn0vZHJhbmQtYmVhY29uLmpzb25gLCB7XG4gICAgICAgICAgY2hhaW5JbmZvLFxuICAgICAgICAgIHJhbmRvbW5lc3MsXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIHsgZGVsYXk6IDEwMDAsIG1heFRyeTogNSB9LFxuICAgICk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihgY29sbGVjdCBmYWlsZWQgOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gIH1cbn1cblxuLy8gSEFDS0VSIE5FV1NcbmlmIChwYXJzZWRBcmdzW1wiY29sbGVjdFwiXSB8fCBwYXJzZWRBcmdzW1wiY29sbGVjdC1oblwiXSkge1xuICAvLyBIYWNrZXIgTmV3cyBBUEk6IGh0dHBzOi8vZ2l0aHViLmNvbS9IYWNrZXJOZXdzL0FQSVxuXG4gIHRyeSB7XG4gICAgYXdhaXQgcmV0cnlBc3luYyhcbiAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJjb2xsZWN0IGF0dGVtcHQgOiBoYWNrZXItbmV3c1wiKTtcbiAgICAgICAgY29uc3QgbmV3c1N0b3JpZXMgPSBhd2FpdCByZWFkSlNPTkZyb21VUkwoXG4gICAgICAgICAgXCJodHRwczovL2hhY2tlci1uZXdzLmZpcmViYXNlaW8uY29tL3YwL25ld3N0b3JpZXMuanNvblwiLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHN0b3JpZXMgPSBbXTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgICBjb25zdCBzdG9yeSA9IGF3YWl0IHJlYWRKU09ORnJvbVVSTChcbiAgICAgICAgICAgIGBodHRwczovL2hhY2tlci1uZXdzLmZpcmViYXNlaW8uY29tL3YwL2l0ZW0vJHtuZXdzU3Rvcmllc1tpXX0uanNvbmAsXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIHN0b3JpZXMucHVzaChzdG9yeSk7XG4gICAgICAgIH1cblxuICAgICAgICBlbnN1cmVEaXJTeW5jKEVOVFJPUFlfRElSKTtcbiAgICAgICAgYXdhaXQgd3JpdGVKU09OKGAke0VOVFJPUFlfRElSfS9oYWNrZXItbmV3cy5qc29uYCwgeyBzdG9yaWVzIH0pO1xuICAgICAgfSxcbiAgICAgIHsgZGVsYXk6IDEwMDAsIG1heFRyeTogNSB9LFxuICAgICk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihgY29sbGVjdCBmYWlsZWQgOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gIH1cbn1cblxuLy8gRU5UUk9QWSBHRU5FUkFUSU9OXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS1cblxuLy8gLS1lbnRyb3B5LWdlbmVyYXRlXG5pZiAocGFyc2VkQXJnc1tcImVudHJvcHktZ2VuZXJhdGVcIl0pIHtcbiAgLy8gQ29weSBleGlzdGluZyBlbnRyb3B5IGZpbGUgdG8gcHJldiB2ZXJzaW9uXG4gIGlmIChleGlzdHNTeW5jKEVOVFJPUFlfRklMRSkpIHtcbiAgICBEZW5vLmNvcHlGaWxlU3luYyhFTlRST1BZX0ZJTEUsIFBSRVZfRU5UUk9QWV9GSUxFKTtcbiAgICBjb25zb2xlLmxvZyhgZW50cm9weSA6IGNvcGllZCB0byAnJHtQUkVWX0VOVFJPUFlfRklMRX0nYCk7XG4gIH1cblxuICAvLyBHZW5lcmF0ZSBhbmQgb3ZlcndyaXRlIGVudHJvcHkgZmlsZVxuICBjb25zdCBlbnRyb3B5ID0gYXdhaXQgZ2VuRW50cm9weSgpO1xuICBhd2FpdCB3cml0ZUpTT04oRU5UUk9QWV9GSUxFLCBlbnRyb3B5KTtcbiAgY29uc29sZS5sb2coXCJlbnRyb3B5IDogZ2VuZXJhdGVkXCIpO1xufVxuXG4vLyAtLWVudHJvcHktdmVyaWZ5XG5pZiAocGFyc2VkQXJnc1tcImVudHJvcHktdmVyaWZ5XCJdKSB7XG4gIC8vIENvbXBhcmUgbmV3bHkgY2FsY3VsYXRlZCByZXN1bHRzIHRvIHdoYXQncyBhbHJlYWR5IGJlZW4gd3JpdHRlbiAoZXhjbHVkaW5nIHRoZSBjcmVhdGVkQXQgcHJvcGVydHkpXG4gIGlmICghZXhpc3RzU3luYyhFTlRST1BZX0ZJTEUpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGByZXF1aXJlZCBmaWxlICcke0VOVFJPUFlfRklMRX0nIG5vdCBmb3VuZGApO1xuICB9XG5cbiAgY29uc3QgY3VycmVudEVudHJvcHkgPSBhd2FpdCByZWFkSlNPTihFTlRST1BZX0ZJTEUpO1xuICBjb25zdCBwdWJsaWNLZXkgPSBhd2FpdCBnZXRQdWJsaWNLZXkoKTtcblxuICBpZiAoIXB1YmxpY0tleSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcInVuYWJsZSB0byByZXRyaWV2ZSBwdWJsaWMga2V5IGZvciB2ZXJpZmljYXRpb25cIik7XG4gIH1cblxuICBpZiAoXG4gICAgIWF3YWl0IGVkLnZlcmlmeShcbiAgICAgIGN1cnJlbnRFbnRyb3B5LnNpZ25hdHVyZSxcbiAgICAgIGN1cnJlbnRFbnRyb3B5Lmhhc2gsXG4gICAgICBwdWJsaWNLZXksXG4gICAgKVxuICApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbnZhbGlkIGhhc2ggc2lnbmF0dXJlXCIpO1xuICB9XG5cbiAgY29uc3QgZW50cm9weSA9IGF3YWl0IGdlbkVudHJvcHkoKTtcbiAgLy8gSWdub3JlIHRoZSBjcmVhdGVkX2F0IGluIHRoZSBjb21taXR0ZWQgdnMgY3VycmVudCBKU09OIGNvbXBhcmlzb25cbiAgLy8gdGhpcyB3aWxsIGFsd2F5cyBiZSBkaWZmZXJlbnQgYmV0d2VlbiBjcmVhdGlvbiBhbmQgdmVyaWZpY2F0aW9uLlxuICBkZWxldGUgY3VycmVudEVudHJvcHkuY3JlYXRlZEF0O1xuICBkZWxldGUgZW50cm9weS5jcmVhdGVkQXQ7XG4gIGFzc2VydE9iamVjdE1hdGNoKGN1cnJlbnRFbnRyb3B5LCBlbnRyb3B5KTtcbiAgY29uc29sZS5sb2coXCJlbnRyb3B5IDogdmVyaWZpZWRcIik7XG59XG5cbi8vIC0tZW50cm9weS1pbmRleFxuaWYgKHBhcnNlZEFyZ3NbXCJlbnRyb3B5LWluZGV4XCJdKSB7XG4gIGNvbnN0IHBhcmVudENvbW1pdElkID0gRGVuby5lbnYuZ2V0KFwiUEFSRU5UX0NPTU1JVF9JRFwiKSB8fCBcIlwiO1xuXG4gIGlmICghU0hBMV9SRUdFWC50ZXN0KHBhcmVudENvbW1pdElkKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIFwiaW52YWxpZCBQQVJFTlRfQ09NTUlUX0lEIGVudmlyb25tZW50IHZhcmlhYmxlLCBtdXN0IGJlIFNIQTEgY29tbWl0IElEXCIsXG4gICAgKTtcbiAgfVxuXG4gIC8vIENhbid0IGluZGV4IHdpdGhvdXQgYSBwcmV2aW91cyBmaWxlIHdoaWNoIGNvbnRhaW5zIHRoZSBoYXNoIHRvIGluZGV4IHRvXG4gIGlmIChleGlzdHNTeW5jKFBSRVZfRU5UUk9QWV9GSUxFKSkge1xuICAgIGNvbnN0IHByZXZFbnRyb3B5ID0gYXdhaXQgcmVhZEpTT04oUFJFVl9FTlRST1BZX0ZJTEUpO1xuICAgIGNvbnN0IHByZXZFbnRyb3B5SGFzaCA9IHByZXZFbnRyb3B5Py5oYXNoO1xuXG4gICAgaWYgKCFwcmV2RW50cm9weUhhc2ggfHwgIVNIQTI1Nl9SRUdFWC50ZXN0KHByZXZFbnRyb3B5SGFzaCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIm1pc3Npbmcgb3IgaW52YWxpZCBlbnRyb3B5IGhhc2ggaW4gZmlsZVwiKTtcbiAgICB9XG5cbiAgICBEZW5vLm1rZGlyU3luYyhJTkRFWF9ESVIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgIGF3YWl0IHdyaXRlSlNPTihgJHtJTkRFWF9ESVJ9LyR7cHJldkVudHJvcHlIYXNofS5qc29uYCwge1xuICAgICAgaWQ6IHBhcmVudENvbW1pdElkLFxuICAgIH0pO1xuICAgIGNvbnNvbGUubG9nKFxuICAgICAgYGVudHJvcHktaW5kZXggOiBpbmRleCBmaWxlIHdyaXR0ZW4gOiAnJHtJTkRFWF9ESVJ9LyR7cHJldkVudHJvcHlIYXNofS5qc29uJyA6ICR7cGFyZW50Q29tbWl0SWR9YCxcbiAgICApO1xuICB9XG59XG5cbi8vIC0tZW50cm9weS11cGxvYWQta3ZcbmlmIChwYXJzZWRBcmdzW1wiZW50cm9weS11cGxvYWQta3ZcIl0pIHtcbiAgY29uc3QgYWNjb3VudElkZW50aWZpZXIgPSBEZW5vLmVudi5nZXQoJ0NGX0FDQ09VTlRfSUQnKVxuICBjb25zdCBuYW1lc3BhY2VJZGVudGlmaWVyID0gRGVuby5lbnYuZ2V0KCdDRl9OQU1FU1BBQ0VfSUQnKVxuICBjb25zdCBrZXlOYW1lID0gXCJsYXRlc3RcIlxuICBjb25zdCBleHBpcmF0aW9uVHRsID0gNjAgKiA2XG4gIGNvbnN0IGF1dGhFbWFpbCA9IERlbm8uZW52LmdldCgnQ0ZfQVVUSF9FTUFJTCcpIHx8ICcnXG4gIGNvbnN0IGF1dGhLZXkgPSBEZW5vLmVudi5nZXQoJ0NGX0FVVEhfS0VZJykgfHwgJydcbiAgY29uc3QgdXJsID0gYGh0dHBzOi8vYXBpLmNsb3VkZmxhcmUuY29tL2NsaWVudC92NC9hY2NvdW50cy8ke2FjY291bnRJZGVudGlmaWVyfS9zdG9yYWdlL2t2L25hbWVzcGFjZXMvJHtuYW1lc3BhY2VJZGVudGlmaWVyfS92YWx1ZXMvJHtrZXlOYW1lfT9leHBpcmF0aW9uX3R0bD0ke2V4cGlyYXRpb25UdGx9YFxuICBjb25zdCBlbnRyb3B5RmlsZSA9IGF3YWl0IHJlYWRKU09OKEVOVFJPUFlfRklMRSlcblxuICBsZXQganNvblxuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiWC1BdXRoLUVtYWlsXCI6IGF1dGhFbWFpbCxcbiAgICAgICAgXCJYLUF1dGgtS2V5XCI6IGF1dGhLZXksXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGVudHJvcHlGaWxlKSxcbiAgICB9KTtcbiAgICBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoYGVudHJvcHktdXBsb2FkLWt2IDogJHtlcnJvci5tZXNzYWdlfWApO1xuICB9XG5cbiAgaWYgKGpzb24uc3VjY2Vzcykge1xuICAgIGNvbnNvbGUubG9nKFxuICAgICAgYGVudHJvcHktdXBsb2FkLWt2IDogc3VjY2VzcyA6IGxhdGVzdCBlbnRyb3B5Lmpzb24gZmlsZSB3cml0dGVuIHRvIENsb3VkZmxhcmUgS1YgOiAke0pTT04uc3RyaW5naWZ5KGpzb24pfWAsXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIGBlbnRyb3B5LXVwbG9hZC1rdiA6IGZhaWxlZCA6IGxhdGVzdCBlbnRyb3B5Lmpzb24gZmlsZSB3YXMgTk9UIHdyaXR0ZW4gdG8gQ2xvdWRmbGFyZSBLViA6ICR7SlNPTi5zdHJpbmdpZnkoanNvbil9YCxcbiAgICApO1xuICB9XG59XG4iXX0=