// Copyright 2018-2022 the Deno authors. All rights reserved. MIT license.
import { Buffer } from "../buffer.ts";
export const timingSafeEqual = (a, b)=>{
    if (a instanceof DataView) a = Buffer.from(a.buffer);
    if (b instanceof DataView) b = Buffer.from(b.buffer);
    if (a instanceof ArrayBuffer) a = Buffer.from(a);
    if (b instanceof ArrayBuffer) b = Buffer.from(b);
    let result = 0;
    if (a.byteLength !== b.byteLength) {
        b = a;
        result = 1;
    }
    for(let i = 0; i < a.byteLength; i++){
        result |= a[i] ^ b[i];
    }
    return result === 0;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3N0ZEAwLjEyOS4wL25vZGUvX2NyeXB0by90aW1pbmdTYWZlRXF1YWwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTgtMjAyMiB0aGUgRGVubyBhdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLiBNSVQgbGljZW5zZS5cbmltcG9ydCB7IEJ1ZmZlciB9IGZyb20gXCIuLi9idWZmZXIudHNcIjtcblxuZXhwb3J0IGNvbnN0IHRpbWluZ1NhZmVFcXVhbCA9IChcbiAgYTogQnVmZmVyIHwgRGF0YVZpZXcgfCBBcnJheUJ1ZmZlcixcbiAgYjogQnVmZmVyIHwgRGF0YVZpZXcgfCBBcnJheUJ1ZmZlcixcbik6IGJvb2xlYW4gPT4ge1xuICBpZiAoYSBpbnN0YW5jZW9mIERhdGFWaWV3KSBhID0gQnVmZmVyLmZyb20oYS5idWZmZXIpO1xuICBpZiAoYiBpbnN0YW5jZW9mIERhdGFWaWV3KSBiID0gQnVmZmVyLmZyb20oYi5idWZmZXIpO1xuICBpZiAoYSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSBhID0gQnVmZmVyLmZyb20oYSk7XG4gIGlmIChiIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIGIgPSBCdWZmZXIuZnJvbShiKTtcblxuICBsZXQgcmVzdWx0ID0gMDtcbiAgaWYgKGEuYnl0ZUxlbmd0aCAhPT0gYi5ieXRlTGVuZ3RoKSB7XG4gICAgYiA9IGE7XG4gICAgcmVzdWx0ID0gMTtcbiAgfVxuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYS5ieXRlTGVuZ3RoOyBpKyspIHtcbiAgICByZXN1bHQgfD0gKGEgYXMgQnVmZmVyKVtpXSBeIChiIGFzIEJ1ZmZlcilbaV07XG4gIH1cblxuICByZXR1cm4gcmVzdWx0ID09PSAwO1xufTtcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwwRUFBMEU7QUFDMUUsU0FBUyxNQUFNLFFBQVEsY0FBYyxDQUFDO0FBRXRDLE9BQU8sTUFBTSxlQUFlLEdBQUcsQ0FDN0IsQ0FBa0MsRUFDbEMsQ0FBa0MsR0FDdEI7SUFDWixJQUFJLENBQUMsWUFBWSxRQUFRLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3JELElBQUksQ0FBQyxZQUFZLFFBQVEsRUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDckQsSUFBSSxDQUFDLFlBQVksV0FBVyxFQUFFLENBQUMsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2pELElBQUksQ0FBQyxZQUFZLFdBQVcsRUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUVqRCxJQUFJLE1BQU0sR0FBRyxDQUFDLEFBQUM7SUFDZixJQUFJLENBQUMsQ0FBQyxVQUFVLEtBQUssQ0FBQyxDQUFDLFVBQVUsRUFBRTtRQUNqQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ04sTUFBTSxHQUFHLENBQUMsQ0FBQztLQUNaO0lBRUQsSUFBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxFQUFFLENBQUU7UUFDckMsTUFBTSxJQUFJLEFBQUMsQ0FBQyxBQUFXLENBQUMsQ0FBQyxDQUFDLEdBQUcsQUFBQyxDQUFDLEFBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUMvQztJQUVELE9BQU8sTUFBTSxLQUFLLENBQUMsQ0FBQztDQUNyQixDQUFDIn0=