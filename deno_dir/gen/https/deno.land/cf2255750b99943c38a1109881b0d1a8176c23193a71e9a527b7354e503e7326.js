import { Buffer } from "../buffer.ts";
export const timingSafeEqual = (a, b) => {
    if (a instanceof DataView)
        a = Buffer.from(a.buffer);
    if (b instanceof DataView)
        b = Buffer.from(b.buffer);
    if (a instanceof ArrayBuffer)
        a = Buffer.from(a);
    if (b instanceof ArrayBuffer)
        b = Buffer.from(b);
    let result = 0;
    if (a.byteLength !== b.byteLength) {
        b = a;
        result = 1;
    }
    for (let i = 0; i < a.byteLength; i++) {
        result |= a[i] ^ b[i];
    }
    return result === 0;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGltaW5nU2FmZUVxdWFsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsidGltaW5nU2FmZUVxdWFsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFFdEMsTUFBTSxDQUFDLE1BQU0sZUFBZSxHQUFHLENBQzdCLENBQWtDLEVBQ2xDLENBQWtDLEVBQ3pCLEVBQUU7SUFDWCxJQUFJLENBQUMsWUFBWSxRQUFRO1FBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3JELElBQUksQ0FBQyxZQUFZLFFBQVE7UUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDckQsSUFBSSxDQUFDLFlBQVksV0FBVztRQUFFLENBQUMsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2pELElBQUksQ0FBQyxZQUFZLFdBQVc7UUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUVqRCxJQUFJLE1BQU0sR0FBRyxDQUFDLENBQUM7SUFDZixJQUFJLENBQUMsQ0FBQyxVQUFVLEtBQUssQ0FBQyxDQUFDLFVBQVUsRUFBRTtRQUNqQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ04sTUFBTSxHQUFHLENBQUMsQ0FBQztLQUNaO0lBRUQsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDckMsTUFBTSxJQUFLLENBQVksQ0FBQyxDQUFDLENBQUMsR0FBSSxDQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDL0M7SUFFRCxPQUFPLE1BQU0sS0FBSyxDQUFDLENBQUM7QUFDdEIsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTgtMjAyMiB0aGUgRGVubyBhdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLiBNSVQgbGljZW5zZS5cbmltcG9ydCB7IEJ1ZmZlciB9IGZyb20gXCIuLi9idWZmZXIudHNcIjtcblxuZXhwb3J0IGNvbnN0IHRpbWluZ1NhZmVFcXVhbCA9IChcbiAgYTogQnVmZmVyIHwgRGF0YVZpZXcgfCBBcnJheUJ1ZmZlcixcbiAgYjogQnVmZmVyIHwgRGF0YVZpZXcgfCBBcnJheUJ1ZmZlcixcbik6IGJvb2xlYW4gPT4ge1xuICBpZiAoYSBpbnN0YW5jZW9mIERhdGFWaWV3KSBhID0gQnVmZmVyLmZyb20oYS5idWZmZXIpO1xuICBpZiAoYiBpbnN0YW5jZW9mIERhdGFWaWV3KSBiID0gQnVmZmVyLmZyb20oYi5idWZmZXIpO1xuICBpZiAoYSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSBhID0gQnVmZmVyLmZyb20oYSk7XG4gIGlmIChiIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIGIgPSBCdWZmZXIuZnJvbShiKTtcblxuICBsZXQgcmVzdWx0ID0gMDtcbiAgaWYgKGEuYnl0ZUxlbmd0aCAhPT0gYi5ieXRlTGVuZ3RoKSB7XG4gICAgYiA9IGE7XG4gICAgcmVzdWx0ID0gMTtcbiAgfVxuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYS5ieXRlTGVuZ3RoOyBpKyspIHtcbiAgICByZXN1bHQgfD0gKGEgYXMgQnVmZmVyKVtpXSBeIChiIGFzIEJ1ZmZlcilbaV07XG4gIH1cblxuICByZXR1cm4gcmVzdWx0ID09PSAwO1xufTtcbiJdfQ==